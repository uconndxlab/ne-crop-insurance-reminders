<!doctype html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>New England Crop Insurance App</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>

<body>
    <h1>Profile</h1>
    <h2 class="auth_username"></h2>
    <div id="profile">

        <h3>Manage</h3>

        <h4>Manage Deadlines</h4>
        <table id="deadlines">
            <tr><td>
                State
            </td>
            <td>
                Crop
            </td>
            <td>
                Acreage Reporting Date
            </td>
            <td>
                Sales Closing Date
            </td>
            <td>
                Production Reporting Date
            </td>
            <td>
                Edit
            </td>
            <td>
                Delete
            </td>
        </tr>

        </table>


    </div>


    <!-- Insert this script at the bottom of the HTML, but before you use any Firebase services -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js'
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js'
        import { getFirestore, collection, query, where, getDocs, doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js'

        // TODO: Replace the following with your app's Firebase project configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBbiuAsUGmV2DCcxWeEC6JSCy-RuQB8TcQ",
            authDomain: "ms-4afc3.firebaseapp.com",
            databaseURL: "https://ms-4afc3-default-rtdb.firebaseio.com",
            projectId: "ms-4afc3",
            storageBucket: "ms-4afc3.appspot.com",
            messagingSenderId: "415927539778",
            appId: "1:415927539778:web:39381dd654222b817075db"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        // Get a reference to the database service
        const auth = getAuth();
        const db = getFirestore();

        function populateDeadlines() {
            // get each document in the schedules collection
            const schedulesCol = collection(db, 'schedules');
            const schedulesQ = query(schedulesCol);

            getDocs(schedulesQ).then((querySnapshot) => {
                querySnapshot.forEach((doc) => {
                    // doc.data() is never undefined for query doc snapshots
                    console.log(doc.id, " => ", doc.data());
                    var row = document.createElement("tr");
                    var state = document.createElement("td");
                    var crop = document.createElement("td");
                    var acreage = document.createElement("td");
                    var sales = document.createElement("td");
                    var production = document.createElement("td");
                    var edit = document.createElement("td");
                    var del = document.createElement("td");

                    state.innerHTML = doc.data().state;
                    crop.innerHTML = doc.data().crop;
                    acreage.innerHTML = new Date(doc.data().acreage_reporting.toDate()).toLocaleDateString();
                    sales.innerHTML = new Date(doc.data().sales_closing.toDate()).toLocaleDateString();
                    production.innerHTML = new Date(doc.data().production_reporting.toDate()).toLocaleDateString();
                    edit.innerHTML = "<button>Edit</button>";
                    del.innerHTML = "<button>Delete</button>";

                    row.appendChild(state);
                    row.appendChild(crop);
                    row.appendChild(acreage);
                    row.appendChild(sales);
                    row.appendChild(production);
                    row.appendChild(edit);
                    row.appendChild(del);

                    document.querySelector("#deadlines").appendChild(row);
                });
            });


        }

        populateDeadlines();

    </script>




</body>



</html>